<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit" 
        xmlns:local="clr-namespace:DeskNote" 
        mc:Ignorable="d" 
        x:Name="_main" 
        x:Class="DeskNote.DeskNoteWindow"
        Title="DeskNote" 
        AllowsTransparency="True" 
        WindowStyle="None" 
        ShowInTaskbar="False" 
        WindowStartupLocation="CenterScreen" 
        MouseDown="_main_MouseDown" 
        MouseMove="_main_MouseMove" 
        MouseEnter="_main_MouseEnter" 
        BorderThickness="1" 
        Height="150.666" 
        ResizeMode="CanResize" 
        Width="246.615" 
        Loaded="_main_Loaded" 
        MouseLeave="_main_MouseLeave" 
        SizeChanged="_main_SizeChanged"
        MouseDoubleClick="_main_MouseDoubleClick" 
        Background="#00000000" 
        Closed="_main_Closed" 
        PreviewKeyDown="_main_PreviewKeyDown">
    <Window.Resources>
        <ObjectDataProvider x:Key="fontStretchesKey" ObjectType="{x:Type local:FontsWrapper}" MethodName="GetFontStretches"/>
        <ObjectDataProvider x:Key="fontWeightsKey" ObjectType="{x:Type local:FontsWrapper}" MethodName="GetFontStyles"/>
        <Style x:Key="NavButton" TargetType="{x:Type Button}">
            <Setter Property="OverridesDefaultStyle" Value="True" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" BorderThickness="0" BorderBrush="Black" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.8" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ThumbStyle" TargetType="{x:Type Thumb}">
            <Setter Property="Template">
                <Setter.Value >
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Ellipse Width="10" Height="5" Stroke="Blue" Fill="Blue" StrokeThickness ="2"></Ellipse>
                    </ControlTemplate >
                </Setter.Value>
            </Setter>
        </Style>

        <LinearGradientBrush x:Key="ActiveItemBrush" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="#FFFFDCA0"/>
            <GradientStop Color="#FFFFD692" Offset="0.18"/>
            <GradientStop Color="#FFFFC45D" Offset="0.39"/>
            <GradientStop Color="#FFFFD178" Offset="1"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="PressedItemBrush" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="#FFFFDCA0"/>
            <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
            <GradientStop Color="#FFFFA60A" Offset="0.39"/>
            <GradientStop Color="#FFFFBC3A" Offset="1"/>
        </LinearGradientBrush>
        <SolidColorBrush x:Key="ContentOutofFocusBrush" Color="#00000000" />
    </Window.Resources>
    <Window.TaskbarItemInfo>
        <TaskbarItemInfo/>
    </Window.TaskbarItemInfo>
    <Window.ContextMenu>
        <ContextMenu>
            <MenuItem x:Name="cmTitle" Header="Desk Note">
                <MenuItem.Icon>
                    <Image Source="pack://application:,,,/Resources/mssvp_9.ico" />
                </MenuItem.Icon>
                <MenuItem x:Name="cmRename" Header="Rename" Click="cmRename_Click"/>
                <!--<MenuItem x:Name="cmNew" Header="New" Click="cmNew_Click"/>
                <MenuItem x:Name="cmLoad" Header="Load"/>-->
                <MenuItem x:Name="cmSave" Header="Save" Click="cmSettingsSave_Click"/>
            </MenuItem>
            <Separator/>
            <MenuItem x:Name="cmInsert" Header="Insert text from clipboard" Click="cmInsertText_Click"/>
            <MenuItem x:Name="cmAdd" Header="Append text from clipboard" Click="cmAddText_Click"/>
            <Separator/>
            <MenuItem x:Name="cmSendToBack" Header="Send to back" IsCheckable="True" Click="cmSendToBack_Click"/>
            <MenuItem x:Name="cmBringToFront" Header="Bring to front" IsCheckable="True" IsChecked="True" IsEnabled="False" Click="cmBringToFront_Click"/>
            <MenuItem x:Name="cmShow" Header="Show" IsCheckable="True" IsChecked="True" Click="cmShowWindow_Click" IsEnabled="False"/>
            <MenuItem x:Name="cmHide" Header="Hide" IsCheckable="True" Click="cmHideWindow_Click"/>
            <Separator/>
            <MenuItem Header="Background">
                <MenuItem x:Name="cmBlur" Header="Glass effect" IsCheckable="True" Click="cmBlur_Click"/>
                <MenuItem x:Name="cmImage" Header="Image" IsCheckable="True" Click="cmImage_Click"/>
                <MenuItem x:Name="cmPresets" Header="Presets" IsEnabled="False">
                </MenuItem>
            </MenuItem>
            <MenuItem x:Name="cmSettings" Header="Settings" Click="cmSettings_Click"/>
            <Separator/>
            <MenuItem x:Name="cmSScreenshot" Header="Screenshot" Click="cmScreenshot_Click"/>
            <MenuItem x:Name="cmSScreenshotFile" Header="Screenshot to file" Click="cmScreenshotFile_Click"/>
            <Separator/>
            <MenuItem x:Name="cmExit" Header="Exit" Click="cmExit_Click"/>
        </ContextMenu>
    </Window.ContextMenu>
    <Window.BorderBrush>
        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
            <GradientStop Color="#FF6C6C6C" Offset="0"/>
            <GradientStop Color="#FFB4B3B3" Offset="0.994"/>
        </LinearGradientBrush>
    </Window.BorderBrush>
    <!--<Window.Triggers>
        <EventTrigger RoutedEvent="local:DeskNoteWindow.FlashWindow">
            <BeginStoryboard>
                <Storyboard>
                    <ColorAnimation AutoReverse="True"
                                     Duration="0:0:.15"
                                     FillBehavior="Stop"
                                     RepeatBehavior="3x"
                                     Storyboard.TargetName="_main"
                                     Storyboard.TargetProperty="Background.Color"
                                     To="AntiqueWhite" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers>-->
    <WindowChrome.WindowChrome>
        <WindowChrome
        CaptionHeight="0"
        ResizeBorderThickness="10" />
    </WindowChrome.WindowChrome>
    <Grid x:Name="_Grid" Margin="1">
        <Grid x:Name="rtbGrid">

            <RichTextBox x:Name="_richTextBox" 
			Foreground="White" 
			MouseDown="_richTextBox_MouseDown" 
			Background="{x:Null}" 
			BorderBrush="{x:Null}" 
			AllowDrop="True" 
			TextChanged="_richTextBox_TextChanged" 
            PreviewDragEnter="_richTextBox_PreviewDragEnter" 
            MouseDoubleClick="_richTextBox_MouseDoubleClick" 
            SelectionChanged="_richTextBox_SelectionChanged" 
            IsDocumentEnabled="True" 
            FontSize="14" 
            AcceptsTab="True" FontFamily="Arial">
                <RichTextBox.ContextMenu>
                    <ContextMenu>
                        <MenuItem Command="ApplicationCommands.Cut"/>
                        <MenuItem Command="ApplicationCommands.Copy"/>
                        <MenuItem Command="ApplicationCommands.Paste"/>
                        <MenuItem x:Name="_rtbCM_Insert" Header="Insert (assign format)" Click="cmInsertText_Click" IsEnabled="False"/>
                        <MenuItem x:Name="_rtbCM_saveStream" Header="Save to rtf-file" Click="cmSaveRTF_Click" IsEnabled="True"/>
                        <MenuItem x:Name="_rtbCM_loadStream" Header="Load rtf-file" Click="cmLoadRTF_Click" IsEnabled="True"/>
                        <MenuItem x:Name="_rtbCM_paste" Header="paste from HTML" Click="cmPasteHTML_click" IsEnabled="True"/>
                        <Separator/>
                        <MenuItem Header="scan for links" Click="scan4URL"/>
                        <MenuItem x:Name="_rtbCM_newURL" Header="create link" Click="_newURL" IsEnabled="False"/>
                        <MenuItem x:Name="_rtbCM_editURL" Header="edit link" Click="_editURL" IsEnabled="False"/>
                        <MenuItem x:Name="_rtbCM_deleteURL" Header="remove link" Click="_deleteURL" IsEnabled="False"/>
                    </ContextMenu>
                </RichTextBox.ContextMenu>
                <RichTextBox.Resources>
                    <Style TargetType="{x:Type Paragraph}">
                        <Setter Property="Margin" Value="0" />
                    </Style>
                    <Style TargetType="{x:Type List}">
                        <Setter Property="Margin" Value="0" />
                        <Setter Property="MarkerOffset" Value="5" />
                        <Setter Property="Padding" Value="15,0,0,0" />
                    </Style>
                    <Style TargetType="{x:Type ListItem}">
                        <Setter Property="Margin" Value="0" />
                    </Style>
                    <Style TargetType="{x:Type RichTextBox}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate>
                                    <Border x:Name="Bd"
									BorderBrush="{TemplateBinding BorderBrush}" 
									BorderThickness="{TemplateBinding BorderThickness}"
									SnapsToDevicePixels="True"
									Background="{TemplateBinding Background}">
                                        <ScrollViewer x:Name="PART_ContentHost"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                    <Style TargetType="{x:Type Hyperlink}">
                        <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self},
						   Path=NavigateUri.OriginalString}" />
                        <EventSetter Event="Hyperlink.Click" Handler="Hyperlink_Click"/>
                    </Style>
                </RichTextBox.Resources>
                <FlowDocument>
                    <Paragraph>
                        <Run x:Name="_Doc" AllowDrop="True" Text="DeskNote"/>
                    </Paragraph>
                </FlowDocument>
            </RichTextBox>
        </Grid>
        <Grid x:Name="_topGrid" Background="#667A7A7A" Height="48" VerticalAlignment="Top" MouseWheel="_topGrid_MouseWheel">
            <Canvas>
                <Canvas.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform x:Name="_GridTopScaleTransform" ScaleY="1" ScaleX="1"/>
                        <SkewTransform/>
                        <RotateTransform/>
                        <TranslateTransform/>
                    </TransformGroup>
                </Canvas.RenderTransform>
                <Rectangle Margin="23,1,22,0" Stroke="#99C7C7C7" Fill="#7FAAAAAA" RadiusX="10" RadiusY="10" Height="24" VerticalAlignment="Top" Visibility="Hidden">
                    <Rectangle.Effect>
                        <DropShadowEffect BlurRadius="4" ShadowDepth="1"/>
                    </Rectangle.Effect>
                </Rectangle>
                <RibbonControlGroup Width="209" VerticalAlignment="Center" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Height="23" HorizontalAlignment="Left" Canvas.Left="23" Canvas.Top="3">
                    <RibbonToggleButton x:Name="_btnBold" 
					Command="{x:Static EditingCommands.ToggleBold}" CommandTarget="{Binding ElementName=_richTextBox}" HorizontalAlignment="Center" Width="22" Height="21" Label="" FontSize="16" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" VerticalAlignment="Center" Content="" Foreground="White" Margin="0,1,0,-1" CornerRadius="0" SmallImageSource="Resources/FormatBar/boldSmall.ico" SnapsToDevicePixels="True" ToolTip="bold" CheckedBackground="{DynamicResource ActiveItemBrush}">
                        <RibbonToggleButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.MouseOverBackground>
                        <RibbonToggleButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.PressedBackground>
                        <RibbonToggleButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" IsLabelVisible="False"/>
                        </RibbonToggleButton.ControlSizeDefinition>
                    </RibbonToggleButton>
                    <RibbonToggleButton x:Name="_btnItalic"                                               
					Command="{x:Static EditingCommands.ToggleItalic}" CommandTarget="{Binding ElementName=_richTextBox}" HorizontalAlignment="Right" Width="22" Label="" FontStyle="Italic" FontSize="16" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" Height="21" VerticalAlignment="Center" Foreground="White" Margin="0,1,0,-1" CornerRadius="0" SmallImageSource="Resources/FormatBar/italicSmall.ico" LargeImageSource="Resources/FormatBar/italicLarge.ico" SnapsToDevicePixels="True" ToolTip="italic">
                        <RibbonToggleButton.CheckedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0" Offset="0"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFFFC45D" Offset="0.39"/>
                                <GradientStop Color="#FFFFD178" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.CheckedBackground>
                        <RibbonToggleButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.MouseOverBackground>
                        <RibbonToggleButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.PressedBackground>
                        <RibbonToggleButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" />
                        </RibbonToggleButton.ControlSizeDefinition>
                    </RibbonToggleButton>
                    <RibbonToggleButton x:Name="_btnUnderline"
					Command="{x:Static EditingCommands.ToggleUnderline}" CommandTarget="{Binding ElementName=_richTextBox}" Height="21" Width="22" Label="" FontSize="16" HorizontalContentAlignment="Stretch" Foreground="White" VerticalAlignment="Center" VerticalContentAlignment="Bottom" Margin="0,1,0,-1" CornerRadius="0" SmallImageSource="Resources/FormatBar/underlineSmall.ico" HorizontalAlignment="Center" SnapsToDevicePixels="True" LargeImageSource="Resources/FormatBar/underlineLarge.ico" ToolTip="underline">
                        <RibbonToggleButton.CheckedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFFFC45D" Offset="0.39"/>
                                <GradientStop Color="#FFFFD178" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.CheckedBackground>
                        <RibbonToggleButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.MouseOverBackground>
                        <RibbonToggleButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonToggleButton.PressedBackground>
                        <RibbonToggleButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" />
                        </RibbonToggleButton.ControlSizeDefinition>
                    </RibbonToggleButton>
                    <RibbonSplitButton Height="23" VerticalAlignment="Top" Width="3" Margin="0,0,0,-2"/>
                    <RibbonRadioButton x:Name="_btnBullets"
                    Command="{x:Static EditingCommands.ToggleBullets}" 
                                            CommandTarget="{Binding ElementName=_richTextBox}" 
                                            Height="21" Width="22" Label="" 
                                            FontSize="16" 
                                            HorizontalContentAlignment="Stretch" 
                                            Foreground="White" 
                                            VerticalAlignment="Center" 
                                            VerticalContentAlignment="Bottom" CornerRadius="0" 
                                            SmallImageSource="Resources/FormatBar/bulletsSmall.ico"
                                            HorizontalAlignment="Center" 
                                            SnapsToDevicePixels="True" 
                                            ToolTip="bullet list" 
                                            TextOptions.TextFormattingMode="Display" 
                                            CanAddToQuickAccessToolBarDirectly="False" Margin="0" Padding="0,2,0,0">
                        <RibbonRadioButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonRadioButton.PressedBackground>
                        <RibbonRadioButton.CheckedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFFFC45D" Offset="0.39"/>
                                <GradientStop Color="#FFFFD178" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonRadioButton.CheckedBackground>
                        <RibbonRadioButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonRadioButton.MouseOverBackground>
                        <RibbonRadioButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" />
                        </RibbonRadioButton.ControlSizeDefinition>
                    </RibbonRadioButton>
                    <RibbonButton x:Name="_btnIncreaseIndent"
                    Command="{x:Static EditingCommands.IncreaseIndentation}" 
                    CommandTarget="{Binding ElementName=_richTextBox}" 
                    Height="21" Width="22" Label="" 
                    FontSize="16" 
                    HorizontalContentAlignment="Stretch" 
                    Foreground="White" 
                    VerticalAlignment="Center" 
                    VerticalContentAlignment="Bottom" CornerRadius="0" 
                    SmallImageSource="Resources/FormatBar/incIndentSmall.ico"
                    HorizontalAlignment="Center" 
                    SnapsToDevicePixels="True" 
                    ToolTip="increase text indent" 
                    TextOptions.TextFormattingMode="Display" 
                    CanAddToQuickAccessToolBarDirectly="False" BorderBrush="{x:Null}">
                        <RibbonButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.MouseOverBackground>
                        <RibbonButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.PressedBackground>
                        <RibbonButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" />
                        </RibbonButton.ControlSizeDefinition>
                    </RibbonButton>
                    <RibbonButton x:Name="_btnDecreaseIndent"
                    Command="{x:Static EditingCommands.DecreaseIndentation}" 
                    CommandTarget="{Binding ElementName=_richTextBox}" 
                    Height="21" Width="22" Label="" 
                    FontSize="16" 
                    HorizontalContentAlignment="Stretch" 
                    Foreground="White" 
                    VerticalAlignment="Center" 
                    VerticalContentAlignment="Bottom" CornerRadius="0" 
                    SmallImageSource="Resources/FormatBar/decIndentSmall.ico"
                    HorizontalAlignment="Center" 
                    SnapsToDevicePixels="True" 
                    ToolTip="decrease text indent" 
                    TextOptions.TextFormattingMode="Display" 
                    CanAddToQuickAccessToolBarDirectly="False">
                        <RibbonButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.MouseOverBackground>
                        <RibbonButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.PressedBackground>

                        <RibbonButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition ImageSize="Small" />
                        </RibbonButton.ControlSizeDefinition>
                    </RibbonButton>
                    <RibbonSplitButton Height="23" VerticalAlignment="Top" Width="3" Margin="0,0,0,-2"/>
                    <Canvas x:Name="canvasTextBackground" Margin="0,-4,0,1" Width="18" MouseUp="colorPickerTextBackground_MouseUp">
                        <Rectangle x:Name="textBackground" Height="20" Stroke="Black" StrokeThickness="0" Canvas.Top="4" Width="18">
                            <Rectangle.Style>
                                <Style TargetType="{x:Type Rectangle}">
                                    <Setter Property="Fill" Value="Transparent" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsMouseDown, RelativeSource={RelativeSource AncestorType=Canvas}}" Value="True">
                                            <Setter Property="Fill" Value="{DynamicResource PressedItemBrush}"></Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=Canvas}}" Value="True">
                                            <Setter Property="Fill" Value="{DynamicResource ActiveItemBrush}"></Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Rectangle.Style>
                        </Rectangle>
                        <Image Source="Resources/FormatBar/textHighlight.ico" Width="18" />
                        <xctk:ColorPicker x:Name="colorPickerTextBackground" VerticalAlignment="Top" HorizontalAlignment="Right" Width="18" SelectedColorChanged="ColorPickerTextBackground_SelectedColorChanged" Height="8" ShowRecentColors="True" ShowDropDownButton="False" Background="{x:Null}" MouseUp="colorPickerTextBackground_MouseUp" Padding="0" BorderThickness="0" ToolTip="Text background color" BorderBrush="{x:Null}" Canvas.Top="16"/>
                    </Canvas>
                    <Canvas x:Name="canvasTextForeground" Margin="0,-4,0,1" Width="18" MouseUp="colorPickerTextForeground_MouseUp">
                        <Rectangle x:Name="textForeground" Height="20" Stroke="Black" StrokeThickness="0" Canvas.Top="4" Width="18">
                            <Rectangle.Style>
                                <Style TargetType="{x:Type Rectangle}">
                                    <Setter Property="Fill" Value="Transparent" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsMouseDown, RelativeSource={RelativeSource AncestorType=Canvas}}" Value="True">
                                            <Setter Property="Fill" Value="{DynamicResource PressedItemBrush}"></Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=Canvas}}" Value="True">
                                            <Setter Property="Fill" Value="{DynamicResource ActiveItemBrush}"></Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Rectangle.Style>

                        </Rectangle>
                        <xctk:ColorPicker x:Name="colorPickerTextForeground" VerticalAlignment="Top" HorizontalAlignment="Right" Width="18" ShowDropDownButton="False" SelectedColorChanged="colorPickerTextForeground_SelectedColorChanged" Height="8" ShowRecentColors="True" MouseUp="colorPickerTextForeground_MouseUp" BorderThickness="0" BorderBrush="{x:Null}" Background="{x:Null}" Canvas.Top="16"/>
                        <Label x:Name="textColorLabel" Content="A" HorizontalAlignment="Right" VerticalAlignment="Top" Width="15" Height="17" HorizontalContentAlignment="Center" Padding="0" VerticalContentAlignment="Center" FontSize="16" MouseUp="textColorLabel_MouseUp" FontWeight="Bold" ToolTip="Text color" Canvas.Left="1" Foreground="White"/>
                    </Canvas>
                    <Canvas x:Name="canvasTextShadow" Margin="0,-4,0,1" Width="18" MouseUp="colorPickerTextForeground_MouseUp">
                        <Rectangle x:Name="textShadow" Height="20" Stroke="Black" StrokeThickness="0" Canvas.Top="4" Width="18" MouseUp="textShadowLabel_MouseUp">
                            <Rectangle.Style>
                                <Style TargetType="{x:Type Rectangle}">
                                    <Setter Property="Fill" Value="Transparent" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsMouseDown, RelativeSource={RelativeSource AncestorType=Canvas}}" Value="True">
                                            <Setter Property="Fill" Value="{DynamicResource PressedItemBrush}"></Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=Canvas}}" Value="True">
                                            <Setter Property="Fill" Value="{DynamicResource ActiveItemBrush}"></Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Rectangle.Style>

                        </Rectangle>
                        <Label x:Name="textShadowLabel" Content="A" HorizontalAlignment="Right" VerticalAlignment="Top" Width="15" Height="17" HorizontalContentAlignment="Center" Padding="0" VerticalContentAlignment="Center" FontSize="16" MouseUp="textShadowLabel_MouseUp" FontWeight="Bold" ToolTip="Text shadow" Canvas.Left="1" Foreground="White">
                            <Label.Effect>
                                <DropShadowEffect BlurRadius="3" ShadowDepth="3"/>
                            </Label.Effect>
                        </Label>
                    </Canvas>
                </RibbonControlGroup>
                <RibbonControlGroup Width="170" VerticalAlignment="Center" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Height="23" HorizontalAlignment="Left" Canvas.Left="18" Canvas.Top="25">
                    <local:FontManager x:Name="fontManager" SelectionChanged="FontManager_SelectionChanged" Height="20" Width="122" VerticalAlignment="Top" FontSize="16"/>
                    <ComboBox x:Name="_fontSize" IsEditable="True" Width="45"
                		SelectionChanged="FontSize_SelectionChanged" Margin="0,0,0,1" PreviewKeyDown="_fontSize_PreviewKeyDown">
                        <ComboBox.Background>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="Black" Offset="0"/>
                                <GradientStop Color="White" Offset="1"/>
                            </LinearGradientBrush>
                        </ComboBox.Background>
                    </ComboBox>
                </RibbonControlGroup>
                <RibbonControlGroup HorizontalAlignment="Left" Width="42" Canvas.Left="187" Canvas.Top="26">
                    <RibbonButton x:Name="_btnIncreaseFontSize" 
                            Width="18" 
                            FontSize="20" 
                            HorizontalContentAlignment="Center" 
                            Foreground="White" CornerRadius="0" 
                            SnapsToDevicePixels="True" 
                            BorderThickness="0" 
                            FontFamily="Arial Black" 
                            CanAddToQuickAccessToolBarDirectly="False" 
                            Label="" 
                            Padding="0" 
                            ScrollViewer.VerticalScrollBarVisibility="Disabled" RenderTransformOrigin="0,0" VerticalContentAlignment="Center" FontWeight="Bold" Content="" HorizontalAlignment="Center" VerticalAlignment="Top" Height="19" Cursor="" Margin="0,-1,0,0" ToolTip="increase textsize of selection" SmallImageSource="Resources/FormatBar/plusSmall.ico" Click="btnIncreaseFontSize_Click">
                        <RibbonButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.MouseOverBackground>
                        <RibbonButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.PressedBackground>
                        <RibbonButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition IsLabelVisible="False" ImageSize="Small" />
                        </RibbonButton.ControlSizeDefinition>
                    </RibbonButton>
                    <RibbonButton x:Name="_btnDecreaseFontSize"
                    	Width="18" FontSize="20" HorizontalContentAlignment="Center" Foreground="White" CornerRadius="0" SnapsToDevicePixels="True" BorderThickness="0" FontFamily="Arial Black" CanAddToQuickAccessToolBarDirectly="False" Label="" Padding="0" ScrollViewer.VerticalScrollBarVisibility="Disabled" RenderTransformOrigin="0,0" VerticalContentAlignment="Center" FontWeight="Bold" Content="" HorizontalAlignment="Center" VerticalAlignment="Top" Height="19" Cursor="" SmallImageSource="Resources/FormatBar/minusSmall.ico" Margin="0,-1,0,0" ToolTip="decrease textsize of selection" Click="btnDecreaseFontSize_Click">
                        <RibbonButton.MouseOverBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFEAC6"/>
                                <GradientStop Color="#FFFFD692" Offset="0.18"/>
                                <GradientStop Color="#FFF3C16A" Offset="0.39"/>
                                <GradientStop Color="#FFFFDE9F" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.MouseOverBackground>
                        <RibbonButton.PressedBackground>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFFFDCA0"/>
                                <GradientStop Color="#FFFFBC4C" Offset="0.18"/>
                                <GradientStop Color="#FFFFA60A" Offset="0.39"/>
                                <GradientStop Color="#FFFFBC3A" Offset="1"/>
                            </LinearGradientBrush>
                        </RibbonButton.PressedBackground>
                        <RibbonButton.ControlSizeDefinition>
                            <RibbonControlSizeDefinition IsLabelVisible="False" ImageSize="Small" />
                        </RibbonButton.ControlSizeDefinition>
                    </RibbonButton>
                </RibbonControlGroup>
            </Canvas>
        </Grid>
        <Grid x:Name="navGrid" Height="27" VerticalAlignment="Bottom" RenderTransformOrigin="0,0" HorizontalAlignment="Center" Width="222" Margin="0,0,0,1" MouseWheel="navGrid_MouseWheel">
            <Grid.RenderTransform>
                <TransformGroup>
                    <ScaleTransform x:Name="_GridNavScaleTransform"/>
                    <SkewTransform/>
                    <RotateTransform/>
                    <TranslateTransform/>
                </TransformGroup>
            </Grid.RenderTransform>
            <Rectangle Margin="49,0,48,0" Stroke="#99C7C7C7" Fill="#7FAAAAAA" RadiusX="10" RadiusY="10" HorizontalAlignment="Center" Width="125" Height="24" VerticalAlignment="Bottom">
                <Rectangle.Effect>
                    <DropShadowEffect BlurRadius="4" ShadowDepth="1"/>
                </Rectangle.Effect>
            </Rectangle>
            <Rectangle x:Name="btnLeft" Height="18" Margin="54.495,0,149.505,2.5" Stroke="Black" Width="18" StrokeThickness="0" ToolTip="prev note" MouseEnter="btnLeft_MouseEnter" MouseLeave="btnLeft_MouseLeave" MouseDown="btnLeft_MouseDown" MouseUp="btnLeft_MouseUp" UseLayoutRounding="False" VerticalAlignment="Bottom" HorizontalAlignment="Center" >
                <Rectangle.Effect>
                    <DropShadowEffect ShadowDepth="2"/>
                </Rectangle.Effect>
                <Rectangle.Fill>
                    <ImageBrush ImageSource="Resources/navi/left_grey.png" Stretch="Uniform"/>
                </Rectangle.Fill>
            </Rectangle>
            <Rectangle x:Name="btnRight" Height="18" Margin="151.172,0,52.828,2.5" Stroke="Black" Width="18" StrokeThickness="0" ToolTip="next note" MouseEnter="btnRight_MouseEnter" MouseLeave="btnRight_MouseLeave" MouseDown="btnRight_MouseDown" MouseUp="btnRight_MouseUp" UseLayoutRounding="False" RenderTransformOrigin="1.681,0.569" HorizontalAlignment="Center" VerticalAlignment="Bottom" >
                <Rectangle.Effect>
                    <DropShadowEffect ShadowDepth="2"/>
                </Rectangle.Effect>
                <Rectangle.Fill>
                    <ImageBrush ImageSource="Resources/navi/right_grey.png" Stretch="Uniform"/>
                </Rectangle.Fill>
            </Rectangle>
            <Label x:Name="lblAct" Content="Label" HorizontalAlignment="Center" Margin="77,0,76,4" Width="69" Padding="0" Height="16" VerticalAlignment="Bottom" HorizontalContentAlignment="Center" Foreground="White" MouseDown="lblAct_MouseDown"/>
        </Grid>
        <Grid x:Name="_bottomGrid" Height="18" VerticalAlignment="Top">
            <Rectangle x:Name="btnDel" Height="18" Stroke="Black" VerticalAlignment="Bottom" Width="18" StrokeThickness="0" ToolTip="delete note" MouseEnter="btnDel_MouseEnter" MouseLeave="btnDel_MouseLeave" MouseDown="btnDel_MouseDown" MouseUp="btnDel_MouseUp" HorizontalAlignment="Left" UseLayoutRounding="False" Canvas.Left="2" Canvas.Top="124" Margin="2,0,0,-0.5" >
                <Rectangle.Fill>
                    <ImageBrush ImageSource="Resources/navi/Del.png" Stretch="Uniform"/>
                </Rectangle.Fill>
            </Rectangle>
            <Rectangle x:Name="btnAdd" Stroke="Black" Width="18" StrokeThickness="0" ToolTip="add note" MouseEnter="btnAdd_MouseEnter" MouseLeave="btnAdd_MouseLeave" MouseDown="btnAdd_MouseDown" MouseUp="btnAdd_MouseUp" HorizontalAlignment="Right" UseLayoutRounding="False" Canvas.Left="202" Canvas.Top="124" Height="18" VerticalAlignment="Bottom" Margin="0,0,2,0" >
                <Rectangle.Fill>
                    <ImageBrush ImageSource="Resources/navi/Add.png" Stretch="Uniform"/>
                </Rectangle.Fill>
            </Rectangle>
        </Grid>
        <ListBox x:Name="listBoxNav" Margin="0,0,0,25" PreviewMouseUp="listBoxNav_PreviewMouseUp" Background="#CC000000" Visibility="Collapsed" SelectionChanged="listBoxNav_SelectionChanged" Foreground="White"/>
    </Grid>
</Window>
